<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="description" content="NB Covid Data Viewer">
    <meta name="author" content="John Gunn">

    <title>NB Covid-19 Data Viewer</title>

    <!-- Includes: bootstrap, jQuery, xlsx, ChartJS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js"></script>

    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js"></script>
    <link href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css" rel="styleshee">

    <!-- Compiled data as JSON -->
    <script type="text/javascript" src="./data/NBPediatricCaseHistory.js"></script>
    <script type="text/javascript" src="./data/NBCaseTrends.js"></script>

    <!-- Styles and Utils -->
    <link href="./css/style.css" rel="stylesheet">
    <script src="./js/API_Calls.js"></script>
    <script src="./js/Globals.js"></script>
    <script src="./js/BuildBoards.js"></script>
    <script src="./js/BuildCharts.js"></script>
    <script src="./js/Navigation.js"></script>
    <script src="./js/GetCovidData.js"></script>
    <script src="./js/uiTools.js"></script>
    
    <style>
        
    </style>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-30Q9WQ4PHV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-30Q9WQ4PHV');
    </script>
</head>
<body onload="showDashboard(true);">
 
<div class="container-fluid main" >
  <!-- Navbar -->
  <div class="row" id="navbar"> 
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark" id='nav'>
      <div class="container-fluid">
        <a class="navbar-brand" href="#" onclick="showDashboard()">NB Daily Covid-19 Data</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDarkDropdown" aria-controls="navbarNavDarkDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Raw Data
              </a>
              <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                <li> 
                  <a class="dropdown-item" href="#"> Case Details &raquo; </a>
                    <ul class="submenu dropdown-menu-dark">
                      <li onclick="showArcGis('ProvincialSummary')"><a class="dropdown-item" href="#">Provincial Summary</a></li>
                      <li onclick="showArcGis('HealthZoneSummary')"><a class="dropdown-item" href="#">Health Zone Summary</a></li>
                      <li onclick="showArcGis('DailyTesting')"><a class="dropdown-item" href="#">Daily Testing</a></li>
                      <li onclick="showArcGis('CaseHistory')"><a class="dropdown-item" href="#">Case History</a></li>
                      <li onclick="showArcGis('CaseOrigin')"><a class="dropdown-item" href="#">Case Origin</a></li>
                      <li onclick="showArcGis('Exposures')"><a class="dropdown-item" href="#">Exposures</a></li>
                    </ul>
                </li>

                <li> 
                  <a class="dropdown-item" href="#"> Healthcare Details &raquo; </a>
                    <ul class="submenu dropdown-menu-dark">
                      <li onclick="showArcGis('HospitalStatusAll')"><a class="dropdown-item" href="#">Hospital Status</a></li>
                      <li onclick="showArcGis('AdultResidentialFacilities')"><a class="dropdown-item" href="#">Adult Residential Facilities</a></li>
                    </ul>
                </li>

                <li> 
                  <a class="dropdown-item" href="#"> Vaccination Details &raquo; </a>
                    <ul class="submenu dropdown-menu-dark">
                      <li onclick="showArcGis('VaccinationSummary')"><a class="dropdown-item" href="#">Vaccination Summary</a></li>
                      <li onclick="showArcGis('VaccinationAgeGroups')"><a class="dropdown-item" href="#">Vaccination Age Groups</a></li>
                      <li onclick="showArcGis('VaccinationHistory')"><a class="dropdown-item" href="#">Vaccination History</a></li>
                      <li onclick="showArcGis('VaccinationTimetable')"><a class="dropdown-item" href="#">Vaccine Timetable</a></li>
                    </ul>
                </li>

                <li> 
                  <a class="dropdown-item" href="#"> Schools Details &raquo; </a>
                    <ul class="submenu dropdown-menu-dark">
                      <li onclick="showArcGis('SchoolsSummary')"><a class="dropdown-item" href="#">Schools Summary</a></li>
                      <li onclick="showArcGis('SchoolsList')"><a class="dropdown-item" href="#">Full List of Schools</a></li>
                    </ul>
                </li>

                <li> 
                  <a class="dropdown-item" href="#"> Compiled Data &raquo; </a>
                    <ul class="submenu dropdown-menu-dark">
                      <li onclick="showCompiledData('pediatricCases')"><a class="dropdown-item" href="#">Pediactric Cases</a></li>
                      <li onclick="showCompiledData('caseHistory')"><a class="dropdown-item" href="#">Case History</a></li>
                    </ul>
                </li>
              </ul>
            </li>                          

            <li class="nav-item">
              <a class="nav-link" href="#" onclick="showChartsDisplay()" id="showCharts" role="button" aria-expanded="false">
                Charts and Graphs
              <!-- <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Charts and Graphs
              </a> -->
              <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                  <li onclick="showDashboard()"><a class="dropdown-item" href="#">Case Dashboard</a></li>
                  <li onclick="showCharts('CaseRate_7DayAverage')"><a class="dropdown-item" href="#">Case Rate (7-Day Rolling Average)</a></li>
                  <li onclick="showCharts('CaseRate_Table')"><a class="dropdown-item" href="#">Case Rate Table</a></li>
                  <li onclick="showFullSizeChart('CaseHistory')"><a class="dropdown-item" href="#">Case History (All Time)</a></li>
                  <li onclick="showFullSizeChart('VaccineHistory')"><a class="dropdown-item" href="#">Vaccine History (All Time)</a></li>
                  <li onclick="showFullSizeChart('HealthZoneSummary')"><a class="dropdown-item" href="#">Current Health Zone Breakdown</a></li>
                  <li onclick="showFullSizeChart('pediatricCases')"><a class="dropdown-item" href="#">Pediatric Cases</a></li>
                  <li onclick="showFullSizeChart('caseTrends')"><a class="dropdown-item" href="#">Case Rate Trends</a></li>
                  <li onclick="showCharts('VaccineAgeGroup')"><a class="dropdown-item" href="#">Vaccination By Age Group</a></li>
                  <li onclick="showCharts('Hospitalizations')"><a class="dropdown-item" href="#">Hospitalization Rate</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  More Info
              </a>
              <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                  <li onclick="showMore('about')"><a class="dropdown-item" href="#">About</a></li>
                  <li onclick="showMore('api_features')"><a class="dropdown-item" href="#">GNB API Features</a></li>
                  <li onclick="showMore('nbcreators')"><a class="dropdown-item" href="#">NB Data Creators</a></li>
                  <li onclick="showMore('moresources')"><a class="dropdown-item" href="#">Sources</a></li>
                  <li onclick="showMore('tipjar')"><a class="dropdown-item" href="#">Tip Jar</a></li>
              </ul>
            </li>
          </ul>
        </div>
        
        <div class="text-light" id="menuHeader"></div>&nbsp;&nbsp;&nbsp;

        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="darkModeSwitch" onclick="toggleDarkMode()" />
          <label class="form-check-label text-light" for="darkModeSwitch">Dark Mode</label>
        </div>
      </div>
    </nav>  

  </div>

  <div class="row" id="loadingSpinner">
    <div class="jumbotron d-flex align-items-center min-vh-100 text-center justify-content-md-center">
        <div class="lds-dual-ring" id="lds-dual-ring"></div>
    </div>      
  </div>
  

  <!-- Button display -->
  <div class="row hidden" id="export_row">
    <div class="col col-md-12 text-right">
        <button type="button" id="export_button" onclick="html_table_to_excel('tblData')" class="btn btn-success btn-sm">Download as Excel</button>
        <button type="button" id="json_button" onclick="downloadJSON()" class="btn btn-primary btn-sm">Download as JSON</button>
    </div>
  </div>   

  <!-- Main Body -->
  <div id="bodyRow">
    <div class="row justify-content-md-center"></div>
  </div>

  <!-- Summary Dashboard (landing) -->
  <div id="summaryDashboard" class="row justify-content-md-center">
  <div class='col-md-8'>
    <!-- Sumamry Table Boards (Top Half) -->
    <div class="row justify-content-md-center">
      
      <div class="col-md-4" id="board1"></div>
      <div class="col-md-4" id="board2"></div>
      <div class="col-md-4" id="board3"></div>
      
    </div>
    <!-- Charts (Lower Half) -->
    <div class="row justify-content-sm-center" id="summaryCharts">
      <!-- Left Column  -->
      <div class="col-md-4" id="board4">
      </div>
      <!-- Right Column -->
      <div class="col-xl-8 d-none d-lg-block" id="chart1_col">
            <div id='dataTableSmall' class='hidden'></div>
            <!-- Active Case History Chart -->
            <canvas id="chart1" width="700" height="340"></canvas>         
      </div>
    </div>
  </div>  

  <div class="row justify-content-md-center" id="dashboard">
    <div class="col-md-auto">
    </div>              
  </div>
            
</div>  
<!-- Large Chart Display (for single chart) -->
<div id="large_chart" class="hidden"> 
  <div class="row justify-content-md-center mt-3 mb-3">
    <div class="col-md-auto">
      <button type="button" class="btn btn-charts btn-outline-primary" id="caseTrends" onclick="showFullSizeChart('caseTrends')">Case Rate Trends</button>
      <button type="button" class="btn btn-charts btn-outline-primary" id="pediatricCases" onclick="showFullSizeChart('pediatricCases')">Pediatric Cases</button>
      <button type="button" class="btn btn-charts btn-outline-primary" id="HealthZoneSummary" onclick="showFullSizeChart('HealthZoneSummary')">Health Zone Summary</button>
      <button type="button" class="btn btn-charts btn-outline-primary" id="caseHistory" onclick="showFullSizeChart('caseHistory')">Case History</button>     
      <button type="button" class="btn btn-charts btn-outline-primary" id="VaccineHistory" onclick="showFullSizeChart('VaccineHistory')">Vaccination History</button>
      <button type="button" class="btn btn-charts btn-outline-primary" id="schoolList" onclick="showFullSizeChart('schoolList')">School Exposures</button>
    </div>
  </div>
  <div class="row justify-content-md-center" id="chart_lg_row">
    <div class="col-md-auto" id="chart_lg_col" >
      <div id="dataTableContainer"></div>
      <canvas id="largeChart" width="800px" height="500px"></canvas>
    </div>
  </div>
</div>        
</div>

<!-- FOOTER -->
<footer class="footer mt-auto py-3 bg-light text-center fixed-bottom">
  <div class="container">
    <span class="text-muted">
      Witten By: <a rel="author" href="https://twitter.com/johnsgunn" target="_blank">John Gunn</a> | 
      Data Source: <a href="#" onclick="showMore('moresources')">View Sources</a> |
      Source Code (GPLv3): <a href="https://github.com/johnsgunn/NBCovidData" target="_blank">NBCovidData</a> | 
      Bugs or Requests: <a href="https://github.com/johnsgunn/NBCovidData/issues" target="_blank">Open An Issue</a> | 
      Tip Jar: <a href="#" onclick="showMore('tipjar')">Buy Me A Coffee</a> 
      <!-- All your data are belong to us -->
    </span>
  </div>
</footer>
    

</body>
</html>
