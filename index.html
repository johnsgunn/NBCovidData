<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="NB Covid Data Viewer">
        <meta name="author" content="John Gunn">

        <title>NB Covid-19 Data Viewer</title>

        <!-- jQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>

        <!-- XLSX creator -->
        <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>

        <!-- ChartJS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js"></script>

        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/4af115cbe5.js" crossorigin="anonymous"></script>

        <!-- Datatables for Bootstrap 5 -->
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs5/jszip-2.5.0/dt-1.11.3/af-2.3.7/b-2.0.1/b-colvis-2.0.1/b-html5-2.0.1/b-print-2.0.1/cr-1.5.4/date-1.1.1/fc-4.0.0/fh-3.2.0/kt-2.6.4/r-2.2.9/rg-1.1.3/rr-1.2.8/sc-2.0.5/sb-1.2.2/sp-1.4.0/sl-1.3.3/datatables.min.css" />

        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/v/bs5/jszip-2.5.0/dt-1.11.3/af-2.3.7/b-2.0.1/b-colvis-2.0.1/b-html5-2.0.1/b-print-2.0.1/cr-1.5.4/date-1.1.1/fc-4.0.0/fh-3.2.0/kt-2.6.4/r-2.2.9/rg-1.1.3/rr-1.2.8/sc-2.0.5/sb-1.2.2/sp-1.4.0/sl-1.3.3/datatables.min.js"></script>

        <!-- Compiled data as JSON -->
        <!-- <script type="text/javascript" src="./data/NBPediatricCaseHistory.js"></script> -->
        <!-- <script type="text/javascript" src="./data/NBCaseTrends.js"></script> -->
        <script type="text/javascript" src="./data/NBHospitalCases.js"></script>
        <script type="text/javascript" src="./data/NBICUCases.js"></script>
        <!-- <script type="text/javascript" src="./data/NBZonePopulations.js"></script> -->
        <script type="text/javascript" src="./data/NBCases.js"></script>
        <script type="text/javascript" src="./data/NBCaseHistoryAge.js"></script>
        <script type="text/javascript" src="./data/NBVaccineAgeGroupHistory.js"></script>
        <script type="text/javascript" src="./data/NBAgePopulation.js"></script>
        <script type="text/javascript" src="./data/NBNewCases.js"></script>
        <!-- <script type="text/javascript" src="./data/NBCaseHistoryAge_v2.js"></script> -->

        <!-- Styles and Utils -->
        <link href="./css/style.css" rel="stylesheet">
        <script src="./js/API_Calls.js"></script>
        <script src="./js/Globals.js"></script>
        <script src="./js/GenerateJsonData.js"></script>
        <script src="./js/BuildRawData.js"></script>
        <script src="./js/BuildBoards.js"></script>
        <script src="./js/BuildCharts.js"></script>
        <script src="./js/Navigation.js"></script>
        <script src="./js/GetCovidData.js"></script>
        <script src="./js/uiTools.js"></script>
        <script src="./js/loadTabData.js"></script>

        <style>
        </style>


        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-30Q9WQ4PHV"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());

            gtag('config', 'G-30Q9WQ4PHV');
        </script>
    </head>
    <body onload="LoadActiveCaseData()">
        <div class="container-fluid main" >
            <div class="row" id="navbar"> 
                <nav class="navbar navbar-expand-lg navbar-dark bg-dark" id='nav'>
                  <div class="container-fluid">
                    <a class="navbar-brand" href="#" onclick="">NB Daily Covid-19 Data</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDarkDropdown" aria-controls="navbarNavDarkDropdown" aria-expanded="false" aria-label="Toggle navigation">
                      <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
                      
                    </div>
                    
                    <div class="text-light" id="menuHeader"><a href="./index_old.html" class='nav-link active'>View Old Version</a></div>&nbsp;&nbsp;&nbsp;
                  </div>
                </nav>  
            
              </div>
              <div><br/><br/></div>
            <div class="row justify-content-md-center" id="bodyRow">
                <div class="row" id="loadingSpinner">
                    <div class="jumbotron d-flex align-items-center min-vh-100 text-center justify-content-md-center">
                        <div class="lds-dual-ring" id="lds-dual-ring"></div>
                    </div>      
                  </div>
                <div class="col-md-8 hidden" id="bodyContainer">
                    
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs" id="navTab" role="tablist">
                        <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="cases-tab" data-bs-toggle="tab" data-bs-target="#cases" 
                            type="button" role="tab" aria-controls="cases" aria-selected="true"
                            onclick="LoadActiveCaseData()">Active Cases</button>
                        </li>
                        
                        <li class="nav-item" role="presentation">
                        <button class="nav-link" id="hospitals-tab" data-bs-toggle="tab" data-bs-target="#hospitals" 
                            type="button" role="tab" aria-controls="hospitals" aria-selected="false"
                            onclick="LoadActiveHospitalData()">Hospitals</button>
                        </li>

                        <!-- VACCINATIONS -->
                        <!-- <li class="nav-item" role="presentation">
                            <button class="nav-link" id="vaccinations-tab" data-bs-toggle="tab" data-bs-target="#vaccinations" 
                                type="button" role="tab" aria-controls="vaccinations" aria-selected="false"
                                >Vaccinations</button>
                            </li> -->

                        <!-- SCHOOLS  -->
                        <!-- <li class="nav-item" role="presentation">
                        <button class="nav-link" id="schools-tab" data-bs-toggle="tab" data-bs-target="#schools" 
                            type="button" role="tab" aria-controls="schools" aria-selected="false">Schools</button>
                        </li> -->

                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="rawdata-tab" data-bs-toggle="tab" data-bs-target="#rawdata" 
                                type="button" role="tab" aria-controls="rawdata" aria-selected="false">Raw Data</button>
                        </li>
                    </ul>
                    
                    <!-- Tab panes -->
                    <div class="tab-content">
                        <!-- CASE SUMMARY -->
                        <div class="tab-pane active" id="cases" role="tabpanel" aria-labelledby="cases-tab">
                            <div class="row">
                                <div class="col">
                                    <p class="display-4">Active Case Summary</p>
                                    <p id="case_dateStamp">Updated on: </p>
                                </div>
                            </div>
                            <div class="row row-cols row-cols-lg-5 g-2 g-lg-3 d-flex ">
                                <div class="col text-center ">
                                  <div class="p-3 border bg-light h-100">
                                      <p class="display-6">New Cases</p>
                                      <div class="h3" id="case_newCases">1234</div>
                                      <div class=".small" id="case_newPCR">123 PCR</div>
                                      <div class=".small" id="case_newPOCT">123 POCT</div>
                                  </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Active Cases</p>
                                        <div class="h3" id="case_activeCases">1234</div>
                                        <div class=".small" id="case_activeCasesChange"></div>
                                        <div class=".small" id="case_activeDisclaimer">*PCR only</div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">In Hospital</p>
                                        <div class="h3" id="case_hospital">123</div>
                                        <div class=".small" id="case_hospitalChange"><i class="fas fa-arrow-up"></i> 10</div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">In ICU</p>
                                        <div class="h3" id="case_icu">12</div>
                                        <div class=".small" id="case_icuChange"><i class="fas fa-arrow-up"></i> 1</div>
                                        <div class=".small" id="case_icuVent">Ventilator</div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Total Deaths</p>
                                        <div class="h3" id="case_deaths">123</div>
                                        <div class=".small" id="case_deathsChange"><i class="fas fa-arrow-up"></i> 2</div>
                                    </div>
                                </div>
                            </div>  
                            <hr/>
                            <div class="row row-cols row-cols-lg-5 g-2 g-lg-3 d-flex ">
                                
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Total Cases</p>
                                        <div class="h3" id="case_total">123456</div>
                                        <div class=".small" id="case_totalChange"><i class="fas fa-arrow-up"></i> 123</div>
                                        <div class=".small" id="case_totalDisclaimer">*PCR + POCT</div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6"><i class="fas fa-plus-circle"></i> Rapid Tests</p>
                                        <div class="h3" id="case_rapid">123456</div>
                                        <div class=".small" id="case_rapidChange"><i class="fas fa-arrow-up"></i> 123</div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6"><i class="fas fa-plus-circle"></i> PCR Tests</p>
                                        <div class="h3" id="case_totalPCR">123456</div>
                                        <div class=".small" id="case_totalPCRChange"><i class="fas fa-arrow-up"></i> 123</div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Recoveries</p>
                                        <div class="h3" id="case_recoveries">123456</div>
                                        <div class=".small" id="case_recoveriesChange"><i class="fas fa-arrow-up"></i> 123</div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Total Hospital</p>
                                        <div class="h3" id="case_totalHospital">1234</div>
                                        <div class=".small" id="case_totalHospitalChange"><i class="fas fa-arrow-up"></i> 12</div>
                                    </div>
                                </div>
                              </div>
                        </div>
                        <!-- VACCINATION SUMMARY -->
                        <div class="tab-pane" id="vaccinations" role="tabpanel" aria-labelledby="vaccinations-tab">Vaccinations</div>

                        <!-- HOSPITAL SUMMARY -->
                        <div class="tab-pane" id="hospitals" role="tabpanel" aria-labelledby="hospitals-tab">
                            <div class="row">
                                <div class="col">
                                    <p class="display-4">Active Hospital Summary</p>
                                    <p id="hosp_dateStamp">Updated on: </p>
                                </div>
                            </div>
                            <div class="row row-cols-2 row-cols-lg-5 g-2 g-lg-3 d-flex ">
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">In Hospital</p>                                        
                                        <div class="row d-flex">
                                            <div class="col text-center">                                                
                                                <div class="fw-bold" id="hosp_hospital">123</div>
                                                <div class=".small" id="hosp_hospitalChange"><i class="fas fa-arrow-up"></i> 10</div>
                                            </div>
                                            <div class="col text-center">
                                                <div class="">Primary</div>
                                                <div class=".small" id="hosp_primaryHosp">123 <i class="fas fa-arrow-up"></i> 10</div>
                                            </div>
                                            <div class="col text-center">
                                                <div class="">Incidental</div>
                                                <div class=".small" id="hosp_incHosp">123 <i class="fas fa-arrow-up"></i> 10</div>
                                            </div>
                                        </div>
                                        <hr/>
                                        <div class="row d-flex">
                                            <div class="col text-center">
                                                <div class="h5">ATH</div>
                                                <div class="" id="hosp_hospATH">123 on 1/1/2022</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">In ICU</p>
                                        <div class="row d-flex">
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">123</div>
                                                <div class=".small" id="hosp_icuChange"><i class="fas fa-arrow-up"></i> 10</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="">Primary</div>
                                                <div class=".small" id="hosp_primaryICU">123 <i class="fas fa-arrow-up"></i> 10</div>
                                            </div>
                                            <div class="col text-center">
                                                <div class="">Incidental</div>
                                                <div class=".small" id="hosp_incICU">123 <i class="fas fa-arrow-up"></i> 10</div>
                                            </div>
                                        </div>
                                        <hr/>
                                        <div class="row d-flex">
                                            <div class="col text-center">
                                                <div class="h5">ATH</div>
                                                <div class="" id="hosp_icuATH">123 on 1/1/2022</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Ventilated</p>
                                        <div class="row d-flex">
                                            <div class="col col-2 text-center"></div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_vent">123</div>
                                                <div class=".small" >&nbsp;</div>  
                                            </div>  
                                            <div class="col text-center">
                                                <div class=".small" id="hosp_ventChange"><i class="fas fa-arrow-up"></i> 10</div>
                                            </div>
                                            <div class="col col-2 text-center"></div>
                                        </div>
                                        <hr/>
                                        <div class="row d-flex">
                                            <div class="col text-center">
                                                <div class="h5">ATH</div>
                                                <div class="" id="hosp_ventATH">123 on 1/1/2022</div>
                                            </div>
                                        </div>       
                                    </div>
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">New Deaths</p>
                                        <div class="row d-flex">
                                            <div class="col col-2 text-center"></div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_newDeaths">123</div>
                                                <div class=".small" >&nbsp;</div>  
                                            </div>  
                                            <div class="col text-center">
                                                <div class=".small" id="hosp_newDeathsChange"><i class="fas fa-arrow-up"></i> 10</div>
                                            </div>
                                            <div class="col col-2 text-center"></div>
                                        </div>
                                        <hr/>
                                        <div class="row d-flex">
                                            <div class="col text-center">
                                                <div class="h5">ATH</div>
                                                <div class="" id="hosp_deathATH">123 on 1/1/2022</div>
                                            </div>
                                        </div>       
                                    </div>
                                </div>
                                
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">7-Day Average</p>
                                        <div class="row d-flex">
                                            <div class="col col-sm-5 text-center">
                                                <div class="fw-bold">In Hospital</div>
                                            </div>
                                            <div class="col text-center">
                                                <div id="hosp_avgHosp"></div>
                                            </div>
                                        </div>
                                        <hr/>
                                        <div class="row d-flex">
                                            <div class="col col-sm-5 text-center">
                                                <div class="fw-bold">In ICU</div>
                                            </div>
                                            <div class="col text-center">
                                                <div id="hosp_avgICU"></div>
                                            </div>
                                        </div>
                                        <hr/>
                                        <div class="row d-flex">
                                            <div class="col col-sm-5 text-center">
                                                <div class="fw-bold">Cases</div>
                                            </div>
                                            <div class="col text-center">
                                                <div id="hosp_avgCases"></div>
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                            <hr/>
                            <div class="row row-cols-2 row-cols-lg-1 g-2 g-lg-3 d-flex ">
                                
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Age Groups</p>

                                        <div class="row d-flex">
                                            <div class="col text-center">
                                                &nbsp;       
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">Under 19</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">20 - 29</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">30 - 39</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">40 - 49</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">50 - 59</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">60 - 69</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">70 - 79</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">80 - 89</div>        
                                            </div>
                                            <div class="col text-center">
                                                <div class="fw-bold" id="hosp_icu">90 +</div>        
                                            </div>
                                        </div>
                                        <hr/>
                                        <div class="row d-flex">
                                            <div class="col text-center">
                                                <div class="fw-bold" >In Hospital</div>
                                                <div class="fw-bold" >In ICU</div>
                                                <div class="fw-bold" >New Deaths</div>
                                            </div>
                                            <div class="col text-center" id="hosp_u19">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                            <div class="col text-center" id="hosp_2029">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                            <div class="col text-center" id="hosp_3039">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                            <div class="col text-center" id="hosp_4049">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                            <div class="col text-center" id="hosp_5059">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                            <div class="col text-center" id="hosp_6069">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                            <div class="col text-center" id="hosp_7079">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                            <div class="col text-center" id="hosp_8089">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                            <div class="col text-center" id="hosp_90p">
                                                <div class="">123</div>  
                                                <div class="">123</div>       
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                
                              </div>
                        </div>
                        <div class="tab-pane" id="schools" role="tabpanel" aria-labelledby="schools-tab">Schools</div>
                        <div class="tab-pane" id="rawdata" role="tabpanel" aria-labelledby="rawdata-tab">
                            <div class="row">
                                <div class="col">
                                    <p class="display-4">Raw Data View</p>
                                    <p id="raw_dateStamp">Updated on: </p>
                                </div>
                            </div>
                            <div class="row row-cols row-cols-lg-5 g-2 g-lg-3 d-flex ">
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Cases</p>
                                        <div class="btn-group-vertical btn-group-sm" role="group" aria-label="raw_caseData">
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('CaseSummary',ProvincialSummaryURL)">Active Case Summary</button>
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('CaseHistory',CaseHistoryURL)">Case History</button>
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('Covid19CaseVaccineStats',Covid19CaseVaccineStatsURL)">Case Rate Stats</button>
                                        </div>  
                                    </div>  
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Hospitals</p>
                                        <div class="btn-group-vertical btn-group-sm" role="group" aria-label="raw_caseData">
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('HospitalStatusAll',HospitalStatusAllURL)">Hospital Summary</button>
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('CovidHospitalAgeStats', CovidHospitalAgeStatsURL)">Hospital Age Stats</button>
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('CovidNewDeathsAgeStatsAll', CovidNewDeathsAgeStatAllURL)">Death Age Stats</button>
                                        </div>  
                                    </div>  
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Vaccination</p>
                                        <div class="btn-group-vertical btn-group-sm" role="group" aria-label="raw_caseData">
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('VaccinationSummary',VaccinationSummaryURL)">Vaccination Summary</button>
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('VaccineAgeGroups',VaccinesByAgeGroupURL)">Vaccination Age Groups</button>
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('VaccinationHistory', VaccineTimetableURL)">Vaccination History</button>
                                        </div>  
                                    </div>  
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Schools</p>
                                        <div class="btn-group-vertical btn-group-sm" role="group" aria-label="raw_caseData">
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('SchoolsSummary',SchoolsDataURL)">Schools Summary</button>
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('SchoolsList',SchoolsListURL)">Schools List</button>
                                        </div>  
                                    </div>  
                                </div>
                                <div class="col text-center ">
                                    <div class="p-3 border bg-light h-100">
                                        <p class="display-6">Compliance</p>
                                        <div class="btn-group-vertical btn-group-sm" role="group" aria-label="raw_caseData">
                                            <button type="button" class="btn btn-outline-secondary"
                                                onclick="LoadRawData('Covid19EnforcementData',Covid19EnforcementDataURL)">Enforcement Data</button>
                                        </div>  
                                    </div>  
                                </div>
                            </div>
                            <div class="row">
                                <div class="col" id="raw_data_display"></div>
                            </div>
                        </div>
                    </div>
                </div>
              </div>
        </div>
    </body>
</html>